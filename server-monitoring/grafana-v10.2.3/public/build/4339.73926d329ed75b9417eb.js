"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4339],{26321:(C,m,e)=>{e.d(m,{Z:()=>t});var a=e(85960);function c({children:n,shouldWrap:s,wrap:_},f){return s?a.cloneElement(_(n)):n}const t=(0,a.forwardRef)(c)},4609:(C,m,e)=>{e.d(m,{NC:()=>M,ZV:()=>s,onCallApi:()=>f});var a=e(85445),c=e(66564),t=e(58533),n=e(58712);const s="grafana_alerting_v2",_=r=>`/api/plugin-proxy/${t.W.OnCall}${r}`,f=n.C.injectEndpoints({endpoints:r=>({grafanaOnCallIntegrations:r.query({query:()=>({url:_("/api/internal/v1/alert_receive_channels/"),params:{filters:!0,integration:[c.As,"legacy_grafana_alerting"]},showErrorAlert:!1}),transformResponse:i=>P(i)?i.results:i,providesTags:["OnCallIntegrations"]}),validateIntegrationName:r.query({query:i=>({url:_("/api/internal/v1/alert_receive_channels/validate_name/"),params:{verbal_name:i},showErrorAlert:!1})}),createIntegration:r.mutation({query:i=>({url:_("/api/internal/v1/alert_receive_channels/"),data:i,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:r.query({query:()=>({url:_("/api/internal/v1/features/"),showErrorAlert:!1})})})});function P(r){return"results"in r&&Array.isArray(r.results)}const{useGrafanaOnCallIntegrationsQuery:A}=f;function M(r){return(0,a.kW)(r)&&"detail"in r.data}},53914:(C,m,e)=>{e.d(m,{q:()=>s});var a=e(56375),c=e.n(a),t=e(85960),n=e(57297);const s=({actions:r,children:i})=>{const u=(0,a.filter)(r,A),O=(0,a.filter)(r,M);return u.length?t.createElement(_,{actions:u},i):O.length?t.createElement(f,{actions:O},i):null},_=({actions:r,children:i})=>{const u=(0,n.Mz)();return P(u,r)?t.createElement(t.Fragment,null,i):null},f=({actions:r,children:i})=>{const u=(0,n.K_)();return P(u,r)?t.createElement(t.Fragment,null,i):null};function P(r,i){return(0,a.chain)(r).pick(i).values().value().some(([u,O])=>O===!0)}function A(r){return Object.values(n.oI).includes(r)}function M(r){return Object.values(n.jU).includes(r)}},28157:(C,m,e)=>{e.d(m,{u:()=>P});var a=e(66681),c=e(85960),t=e(47257),n=e(49199),s=e(16901),_=e(81828),f=e(76679);function P({currentAlertmanager:M}){const r=(0,t.wW)(A),i=M===f.GC,{currentData:u}=_.alertmanagerApi.endpoints.getAlertmanagerChoiceStatus.useQuery(void 0,{skip:!i});if(!(u?.alertmanagersChoice&&[s.TE.External,s.TE.All].includes(u?.alertmanagersChoice))||!i)return null;const l=u.numExternalAlertmanagers>0;return u.alertmanagersChoice===s.TE.External?c.createElement(n.b,{title:"Grafana alerts are not delivered to Grafana Alertmanager"},"Grafana is configured to send alerts to external Alertmanagers only. Changing Grafana Alertmanager configuration will not affect delivery of your alerts.",c.createElement("div",{className:r.adminHint},"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator.")):u.alertmanagersChoice===s.TE.All&&l?c.createElement(n.b,{title:"You have additional Alertmanagers to configure",severity:"warning"},"Ensure you make configuration changes in the correct Alertmanagers; both internal and external. Changing one will not affect the others.",c.createElement("div",{className:r.adminHint},"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator.")):null}const A=M=>({adminHint:(0,a.css)`
    font-size: ${M.typography.bodySmall.fontSize};
    font-weight: ${M.typography.bodySmall.fontWeight};
  `})},46911:(C,m,e)=>{e.d(m,{g:()=>f});var a=e(66681),c=e(85960),t=e(47257),n=e(40377),s=e(13086),_=e(97666);const f=({children:A,icon:M,color:r="secondary",...i})=>{const u=(0,t.wW)(P),O=typeof i.onClick=="function";return c.createElement("div",{className:(0,a.cx)({[u.interactive]:O}),...i},c.createElement(n.x,{variant:"bodySmall",color:r},c.createElement(s.K,{direction:"row",alignItems:"center",gap:.5,wrap:"wrap"},M&&c.createElement(_.J,{size:"sm",name:M}),A)))},P=()=>({interactive:(0,a.css)`
    cursor: pointer;
  `})},35855:(C,m,e)=>{e.d(m,{c:()=>t});var a=e(85960),c=e(47257);const t=({children:n})=>{const s=(0,c.l4)();return a.createElement("strong",{style:{color:s.colors.text.primary}},n)}},27908:(C,m,e)=>{e.d(m,{u:()=>r});var a=e(66681),c=e(78344),t=e.n(c),n=e(85960),s=e(53565),_=e(47257),f=e(62577),P=e(29165),A=e(55855),M=e(23694);function r({format:u,textDefinition:O,downloadFileName:l,onClose:o}){const E=(0,_.wW)(i),g=(0,n.useCallback)(()=>{const d=new Blob([O],{type:`application/${u};charset=utf-8`});t()(d,`${l}.${u}`)},[O,l,u]),v=(0,n.useMemo)(()=>{const d=M.uN[u];return d.formatter?d.formatter(O):O},[u,O]);return n.createElement("div",{className:E.container},n.createElement("div",{className:E.content},n.createElement(s.Z,{disableWidth:!0},({height:d})=>n.createElement(f.p,{width:"100%",height:d,language:u,value:v,monacoOptions:{minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",readOnly:!0}}))),n.createElement("div",{className:E.actions},n.createElement(P.zx,{variant:"secondary",onClick:o},"Cancel"),n.createElement(A.m,{icon:"copy",getText:()=>O},"Copy code"),n.createElement(P.zx,{icon:"download-alt",onClick:g},"Download")))}const i=u=>({container:(0,a.css)`
    display: flex;
    flex-direction: column;
    height: 100%;
    gap: ${u.spacing(2)};
  `,content:(0,a.css)`
    flex: 1 1 100%;
  `,actions:(0,a.css)`
    flex: 0;
    justify-content: flex-end;
    display: flex;
    gap: ${u.spacing(1)};
  `})},29657:(C,m,e)=>{e.d(m,{i:()=>n});var a=e(85960),c=e(63153),t=e(47831);function n({activeTab:s,onTabChange:_,children:f,onClose:P,formatProviders:A,title:M="Export"}){const r=Object.values(A).map(i=>({label:i.name,value:i.exportFormat}));return a.createElement(c.d,{title:M,subtitle:"Select the format and download the file or copy the contents to clipboard",tabs:a.createElement(t.mg,{tabs:r,setActiveTab:_,activeTab:s}),onClose:P,size:"md"},f)}},23694:(C,m,e)=>{e.d(m,{uN:()=>n});const a={name:"JSON",exportFormat:"json",formatter:_=>{try{return JSON.stringify(JSON.parse(_),null,4)}catch{return _}}},c={name:"YAML",exportFormat:"yaml"},t={name:"Terraform (HCL)",exportFormat:"hcl"},n={[a.exportFormat]:a,[c.exportFormat]:c,[t.exportFormat]:t},s=[a,c]},66564:(C,m,e)=>{e.d(m,{As:()=>a,Fs:()=>n,hM:()=>c});const a="grafana_alerting";var c=(s=>(s.OnCall="oncall",s))(c||{});const t=(s,_)=>_.includes(s),n=(s,_)=>{if(!s.grafana_managed_receiver_configs)return!1;const f=s.grafana_managed_receiver_configs.length===1,P=t(s.grafana_managed_receiver_configs[0]?.settings?.url??"",_.map(A=>A.integration_url));return f&&P}},47831:(C,m,e)=>{e.d(m,{CU:()=>E,mg:()=>g});var a=e(66681),c=e(48525),t=e(85960),n=e(10476),s=e(53565),_=e(47257),f=e(63153),P=e(70523),A=e(94439),M=e(29165),r=e(14607),i=e(97666),u=e(62577),O=e(38884),l=e(9001);const o=[{label:"Yaml",value:"yaml"}],E=({onClose:h})=>{const[I,R]=(0,t.useState)("yaml"),{setValue:y}=(0,n.Gc)(),L=(0,_.wW)(T),U=B=>{for(const W in B)y(W,B[W]);h()};return t.createElement(f.d,{title:"Inspect Alert rule",subtitle:t.createElement("div",{className:L.subtitle},t.createElement(g,{tabs:o,setActiveTab:R,activeTab:I})),onClose:h},I==="yaml"&&t.createElement(v,{onSubmit:U}))};function g({tabs:h,activeTab:I,setActiveTab:R}){return t.createElement(P.J,null,h.map((y,L)=>t.createElement(A.O,{key:`${y.value}-${L}`,label:y.label,value:y.value,onChangeTab:()=>R(y.value),active:I===y.value})))}const v=({onSubmit:h})=>{const I=(0,_.wW)(p),{getValues:R}=(0,n.Gc)(),y=(0,O.yh)(R()),[L,U]=(0,t.useState)((0,c.$w)(y)),B=()=>{const W=(0,c.zD)(L),K=R(),x=D(W);h({...K,...x})};return t.createElement(t.Fragment,null,t.createElement("div",{className:I.applyButton},t.createElement(M.zx,{type:"button",onClick:B},"Apply"),t.createElement(r.u,{content:t.createElement(d,null),theme:"info",placement:"left-start",interactive:!0},t.createElement(i.J,{name:"exclamation-triangle",size:"xl"}))),t.createElement("div",{className:I.content},t.createElement(s.Z,{disableWidth:!0},({height:W})=>t.createElement(u.p,{width:"100%",height:W,language:"yaml",value:L,onBlur:U,monacoOptions:{minimap:{enabled:!1}}}))))};function d(){return t.createElement("div",null,"The YAML content in the editor only contains alert rule configuration ",t.createElement("br",null),"To configure Prometheus, you need to provide the rest of the"," ",t.createElement("a",{href:"https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/",target:"_blank",rel:"noreferrer"},"configuration file content."))}function D(h){return(0,l.cG)(h)?(0,O.WL)(h):(0,l.yF)(h)?(0,O.lN)(h):{}}const p=h=>({content:(0,a.css)`
    flex-grow: 1;
    height: 100%;
    padding-bottom: 16px;
    margin-bottom: ${h.spacing(2)};
  `,applyButton:(0,a.css)`
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    flex-grow: 0;
    margin-bottom: ${h.spacing(2)};
  `}),T=()=>({subtitle:(0,a.css)`
    display: flex;
    align-items: center;
    justify-content: space-between;
  `})},75636:(C,m,e)=>{e.d(m,{j:()=>n});var a=e(85960),c=e(30694),t=e(91);function n(){const{search:s}=(0,c.TH)(),_=(0,a.useMemo)(()=>new URLSearchParams(s),[s]),f=(0,a.useCallback)((P,A)=>{t.E1.partial(P,A)},[]);return[_,f]}},5493:(C,m,e)=>{e.d(m,{y:()=>a});const a={discord:"discord",email:"envelope",googlechat:"google-hangouts-alt",hipchat:"hipchat",line:"line",pagerduty:"pagerduty",slack:"slack",teams:"microsoft",telegram:"telegram-alt",webhook:"link",sns:"amazon"}},59439:(C,m,e)=>{e.d(m,{$2:()=>M,tK:()=>r,w2:()=>P});var a=e(56375),c=e.n(a),t=e(16901),n=e(41460);function s(l,o){const E=_(l,o),g=new Map(o.map(v=>[v,{match:!1,matcher:null}]));return l.forEach(v=>{const d=o.find(D=>O(v,D));d&&g.set(d,{match:!0,matcher:v})}),{matches:E,labelsMatch:g}}function _(l,o){for(const E of l)if(!u(E,o))return!1;return!0}function f(l,o){let E=[];const g=s(l.object_matchers??[],o);if(!g.matches)return[];if(l.routes)for(const v of l.routes){let d=f(v,o);if(E=E.concat(d),d.length&&!v.continue)break}return E.length===0&&E.push({route:l,labelsMatch:g.labelsMatch}),E}function P(l){function o(g){g.object_matchers=(0,n.QO)(g),delete g.matchers,delete g.match,delete g.match_re,g.routes?.forEach(o)}const E=structuredClone(l);return o(E),E}function A(l,o,E){const g=[];return E.reduce((v,d)=>{const D=d.alerts.filter(p=>{const T=Object.entries(p.labels);return f(l,T).some(h=>h.route===o)});return D.length&&v.push({...d,alerts:D}),v},g)}function M(l,o,E){const g=(0,a.merge)({},l,E),v=(0,a.pick)(g,["receiver","group_by","group_wait","group_interval","repeat_interval","mute_time_intervals"]);return(0,a.reduce)(v,(D={},p,T)=>{const h=p!==void 0,I=h&&o[T]===void 0,R=h&&o[T]==="",y=T==="group_by"&&h&&(0,a.isArray)(o[T])&&o[T]?.length===0;return(I||R||y)&&(D[T]=p),D},{})}function r(l){return{...l,routes:l.routes?.map(o=>{const E=M(l,o);return r({...o,...E})})}}const i={[t._M.equal]:(l,o)=>l===o,[t._M.notEqual]:(l,o)=>l!==o,[t._M.regex]:(l,o)=>new RegExp(o).test(l),[t._M.notRegex]:(l,o)=>!new RegExp(o).test(l)};function u(l,o){const[E,g,v]=l;let d="";const D=Object.fromEntries(o)[E];D&&(d=D);const p=i[g];if(!p)throw new Error(`no such operator: ${g}`);return p(d,v)}function O(l,o){let[E,g]=o;const[v,d,D]=l;if(E!==v)return!1;const p=i[d];if(!p)throw new Error(`no such operator: ${d}`);return p(g,D)}}}]);

//# sourceMappingURL=4339.73926d329ed75b9417eb.js.map