"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[8741],{48187:(Q,h,e)=>{e.r(h),e.d(h,{AuthConfigPageUnconnected:()=>y,default:()=>j});var n=e(85960),S=e(36752),x=e(43183),v=e(79055),T=e(14559),E=e(20989),p=e(66681),G=e(47257),U=e(13086),P=e(97666),A=e(40377);const F=()=>{const t=(0,G.wW)(N);return n.createElement("div",{className:t.container},n.createElement(U.K,{gap:1,alignItems:"center"},n.createElement(P.J,{name:"cog"}),n.createElement(A.x,null,"Configuration required")),n.createElement(A.x,{variant:"bodySmall",color:"secondary"},"You have no authentication configuration created at the moment."),n.createElement(v.h,{href:"https://grafana.com/docs/grafana/latest/auth/overview/",external:!0},"Refer to the documentation on how to configure authentication"))},N=t=>({container:(0,p.css)({display:"flex",flexDirection:"column",gap:t.spacing(2),backgroundColor:t.colors.background.secondary,borderRadius:t.shape.radius.default,padding:t.spacing(3),width:"max-content",margin:t.spacing(3,"auto")})}),R=F;var Z=e(6556),l=e(72435),B=e(67192);const H="admin/authentication/";function L(t){return H+(t.configPath||t.id)}const M={github:["github","GitHub"],gitlab:["gitlab","GitLab"],google:["google","Google"],generic_oauth:["lock","Generic OAuth"],grafana_com:["grafana","Grafana.com"],azuread:["microsoft","Azure AD"],okta:["okta","Okta"]};function W({providerId:t,enabled:a,configPath:o,authType:s,onClick:g}){const i=L({configPath:o,id:t}),[c,d]=M[t]||["lock",t.toUpperCase()];return n.createElement(l.Z,{href:i,onClick:g},n.createElement(l.Z.Heading,null,d),n.createElement(l.Z.Meta,null,s),(0,Z.Mo)(c)&&n.createElement(l.Z.Figure,null,n.createElement(P.J,{name:c,size:"xxxl"})),n.createElement(l.Z.Actions,null,n.createElement(B.C,{text:a?"Enabled":"Not enabled",color:a?"green":"blue"})))}var C=e(85445),z=e(90857),D=e(49683),I=e(95162),f=e(67368),u=e(99848);function O(){return async t=>{if(D.Vt.hasPermission(I.AccessControlAction.SettingsRead)){t((0,u.uX)()),t(J());const a=await(0,C.i)().get("/api/admin/settings");return t((0,u.AW)(a)),await t(V()),t((0,u._E)()),a}}}function J(){return async t=>{if(!z.config.featureToggles.ssoSettingsApi)return[];const a=await(0,C.i)().get("/api/v1/sso-settings");return t((0,u.sg)(a)),a}}function V(){return async t=>{const a=(0,f.getRegisteredAuthProviders)(),o={},s=[];for(const i of a)s.push((0,f.getAuthProviderStatus)(i.id));const g=await Promise.all(s);for(let i=0;i<a.length;i++){const c=a[i];o[c.id]=g[i]}t((0,u.AB)(o))}}function $(t){return async a=>{if(contextSrv.hasPermission(AccessControlAction.SettingsWrite))try{return await lastValueFrom(getBackendSrv().fetch({url:"/api/admin/settings",method:"PUT",data:t,showSuccessAlert:!1,showErrorAlert:!1})),a(resetError()),!0}catch(o){if(console.log(o),isFetchError(o)){o.isHandled=!0;const s={message:o.data?.message,errors:o.data?.errors};return a(setError(s)),!1}}return!1}}function K(t){const{isLoading:a,providerStatuses:o,providers:s}=t.authConfig;return{isLoading:a,providerStatuses:o,providers:s}}const X={loadSettings:O},Y=(0,S.connect)(K,X),y=({providerStatuses:t,isLoading:a,loadSettings:o,providers:s})=>{(0,n.useEffect)(()=>{o()},[o]);const i=(0,f.getRegisteredAuthProviders)().filter(r=>!t[r.id]?.hide),c=r=>{(0,x.ff)("authentication_ui_provider_clicked",{provider:r})},d=i.length?[...i.map(r=>({provider:r.id,settings:{...t[r.id],configPath:r.configPath,type:r.type}})),...s]:s;return n.createElement(E.T,{navId:"authentication",subTitle:n.createElement(n.Fragment,null,"Manage your auth settings and configure single sign-on. Find out more in our"," ",n.createElement(v.h,{href:"https://grafana.com/docs/grafana/next/setup-grafana/configure-security/configure-authentication"},"documentation"),".")},n.createElement(E.T.Contents,{isLoading:a},d.length?n.createElement(T.r,{gap:3,minColumnWidth:34},d.map(({provider:r,settings:m})=>n.createElement(W,{key:r,authType:m.type||"OAuth",providerId:r,displayName:r,enabled:m.enabled,onClick:()=>c(r),configPath:m.configPath}))):n.createElement(R,null)))},j=Y(y)}}]);

//# sourceMappingURL=AdminAuthentication.573839d30b117b1d961e.js.map